clear all
close all

KK = [1 4]

for NN = 100

    str = "approx_K/utrue_"+NN+".txt";
    ut = import_freefem_vector(str);
    str = "approx_K/ftrue1_"+NN+".txt";
    ft1 = import_freefem_vector(str);
    str = "approx_K/ftrue2_"+NN+".txt";
    ft2 = import_freefem_vector(str);


    % str = "approx_KRound/utrue_"+NN+".txt";
    % ut = import_freefem_vector(str);
    % str = "approx_KRound/ftrue1_"+NN+".txt";
    % ft1 = import_freefem_vector(str);
    % str = "approx_KRound/ftrue2_"+NN+".txt";
    % ft2 = import_freefem_vector(str);


    W = 8:2:50;



    for K1 = 1%:2
        for K2 = 1%:2
            % W = 8:2:96;
            error_uh = zeros(4,length(W));
            error_fh1 = zeros(4,length(W));
            error_fh2 = zeros(4,length(W));
            error    = zeros(4,length(W));

            k = 0;


            for k = KK%4
                wl = 1;
                for w = W
                    stru = "approx_K/uh_"+k+"_"+K1+"_"+K2+"_"+NN+"_"+w+".txt";
                    strf1 = "approx_K/fh1_"+k+"_"+K1+"_"+K2+"_"+NN+"_"+w+".txt";
                    strf2 = "approx_K/fh2_"+k+"_"+K1+"_"+K2+"_"+NN+"_"+w+".txt";

                    %             stru = "approx_KRound/uh_"+k+"_"+K1+"_"+K2+"_"+NN+"_"+w+".txt";
                    %             strf1 = "approx_KRound/fh1_"+k+"_"+K1+"_"+K2+"_"+NN+"_"+w+".txt";
                    %             strf2 = "approx_KRound/fh2_"+k+"_"+K1+"_"+K2+"_"+NN+"_"+w+".txt";


                    uh = import_freefem_vector(stru);
                    fh1 = import_freefem_vector(strf1);
                    fh2 = import_freefem_vector(strf2);

                    error_uh(k,wl) = norm(uh-ut)/(norm(ut));      %%RELATIVE - ERROR
                    %         error_fh(K,wl) = norm(fh-ft)/(norm(ft));
                    %         error_uh(K,wl) = sum(abs(uh-ut))/length(ut);
                    %         error_fh1(K,wl) = sum(abs(fh1-ft1))/length(ft1);
                    %         error_fh2(K,wl) = sum(abs(fh2-ft2))/length(ft2);
                    error_fh1(k,wl) = norm(fh1-ft1)/norm(ft1);
                    error_fh2(k,wl) = norm(fh2-ft2)/norm(ft2);
                    %% mean absolute error (MAE)


                    all = [uh;fh1;fh2]; allt = [ut;ft1;ft2];

                    error(k,wl) = norm(all-allt)/(norm(allt));
                    %             error(k,wl) = sum((all-allt).^2./allt.^2);

                    wl = wl+1;

                end



                if k == 1
                    str = '-*';
                elseif k == 2
                    str = '-o';
                elseif k == 3
                    str = '-d';
                elseif k == 4
                    str = '-s';
                end


                figure(1)
                subplot(3,1,1)
                hold on
                plot(W, error_uh(k,:)*100,str)
                axis tight
                subplot(3,1,2)
                hold on
                plot(W, error_fh1(k,:)*100,str)
                axis tight
                subplot(3,1,3)
                hold on
                plot(W, error_fh2(k,:)*100,str)
                axis tight


            end


            figure(2)
            error = error*100;
            plot(W, error(1,:),'-*',W, error(4,:),'-s')
            legend('$K_1 = \omega, K_2 = 10$','$K_1 = \omega, K_2 = \omega$','Interpreter','latex')
            xlabel('\textbf{time-frequency $\omega$}','Interpreter','latex')
            ylabel('total relativ L^2-error [%]')
            axis tight

        end

    end

end

timeAE100 = -[ -96.242799 -76.852811 -80.473034 -80.470342 -80.77333 -86.907275 -88.569418 -92.460402 -95.294383 -96.092647 -100.578491 -104.374539 -101.947042 -115.493545 -122.128956 -128.460115 -129.192182 -136.288335 -141.285439 -130.542977 -134.340527 -138.60583   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1;
    -94.884896 -79.093037 -81.358219 -86.104273 -92.953068 -94.090319 -100.697934 -110.479361 -111.181663 -114.081644 -118.451991 -124.552214 -131.463156 -135.358823 -140.583444 -145.547182 -149.68802 -156.16808 -162.850019 -165.715822 -171.903874 -176.839357   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1;
    -93.108899 -78.049399 -80.029405 -78.269441 -77.564886 -81.243863 -82.504798 -80.446533 -83.466517 -84.994741 -82.164406 -85.409396 -88.656111 -92.715538 -96.514276 -97.04765 -104.869441 -103.893752 -103.024309 -101.948462 -100.60979 -105.821193   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1;
    -93.157997 -75.927919 -83.354307 -87.161549 -96.815108 -105.77159 -107.61093 -114.724547 -122.403789 -129.182969 -135.589977 -143.35979 -152.97093 -158.883307 -167.271619 -173.554286 -181.747535 -189.349128 -197.742587 -197.869464 -215.249822 -212.207081   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1];

timeAE200 = - [ -393.397086 -299.559709 -305.652786 -329.353444 -345.410865 -348.349134 -353.639657 -380.180152 -387.696268 -391.012155 -422.947981 -445.885253 -470.511293 -499.548987 -531.040047 -572.952644 -578.656905 -592.484466 -651.280912 -615.419193 -666.225488 -688.581411 -699.710505 -668.427896 -707.983237 -663.419135 -683.542365 -750.075763 -734.87392 -673.028703 -747.232687 -709.369166 -735.755328 -750.532505 -759.703855 -759.522017 -793.009007 -825.753222 -834.812368 -863.473854 -898.200611 -926.645628 -935.731983 -931.719888 -937.365118 -989.08801 -993.327973 3.162020133e-322 6.577001877e-320 -0.02083333333 5.453529185e-312 4.644744869e-310   0 4.644744869e-310 4.644744869e-310 3.162020133e-322 6.798343287e-320 -0.02083333333 5.474749142e-312   0 4.644744869e-310 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.019684696e-320 -0.02083333333 5.4959691e-312 4.644744869e-310   0 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.241026105e-320 -0.02083333333 5.517189058e-312   0 4.644744869e-310 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.462367515e-320 -0.02083333333 5.538409016e-312 4.644744869e-310   0 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.683708924e-320 -0.02083333333 5.559628974e-312   0 4.644744869e-310 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.905050333e-320 -0.02083333333 5.580848932e-312 4.644744869e-310;
    -379.130726 -314.44505 -316.42995 -350.427664 -355.020878 -394.047145 -411.399989 -458.10155 -452.432122 -483.715159 -513.557292 -525.231711 -548.260339 -557.736754 -613.577822 -609.588904 -656.763882 -691.217665 -717.460928 -757.884152 -786.523714 -750.924791 -732.919844 -802.110356 -846.124974 -865.759413 -820.624854 -851.240962 -873.002163 -958.505579 -913.213219 -941.431854 -975.868742 -989.479587 -1030.812275 -1145.225132 -1162.081382 -1118.661112 -1227.684332 -1255.332563 -1207.654368 -1241.432449 -1235.89044 -1266.558462 -1300.379236 -1313.439615 -1326.747106 4.644744869e-310 3.162020133e-322 6.608622079e-320 -0.02083333333 5.474749142e-312   0 4.644744869e-310 4.644744869e-310 4.644744869e-310 3.162020133e-322 6.829963488e-320 -0.02083333333 5.4959691e-312 4.644744869e-310   0 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.051304897e-320 -0.02083333333 5.517189058e-312   0 4.644744869e-310 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.272646307e-320 -0.02083333333 5.538409016e-312 4.644744869e-310   0 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.493987716e-320 -0.02083333333 5.559628974e-312   0 4.644744869e-310 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.715329125e-320 -0.02083333333 5.580848932e-312 4.644744869e-310   0 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.936670535e-320 -0.02083333333 5.60206889e-312;
    -381.166613 -304.626519 -315.761167 -303.962823 -304.799072 -325.380008 -300.6285 -300.552148 -313.597391 -306.672439 -334.884506 -349.701275 -345.5443 -360.918066 -376.776723 -404.446266 -415.237648 -412.780203 -426.350716 -441.344139 -434.192727 -447.151726 -464.937418 -455.433523 -441.296997 -457.111946 -469.480295 -485.31858 -453.507883 -433.322216 -451.091889 -444.952023 -455.94856 -385.163588 -404.23953 -421.151567 -419.308861 -422.998952 -427.852402 -436.711808 -441.093299 -399.735568 -364.850454 -314.584462 -298.374172 -289.825199 -337.096059 4.644744869e-310 4.644744869e-310 3.162020133e-322 6.64024228e-320 -1.12085573 7.596744933e-312 4.644744869e-310   0 4.644746223e-310 4.644744869e-310 3.162020133e-322 6.861583689e-320 -1.119570488 7.617964891e-312   0 4.644744869e-310 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.082925099e-320 -1.118009294 7.639184849e-312 4.644744869e-310   0 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.304266508e-320 -1.116297465 7.660404807e-312   0 4.644744869e-310 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.525607917e-320 -1.114529807 7.681624765e-312 4.644744869e-310   0 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.746949327e-320 -1.112769424 7.702844723e-312   0 4.644744869e-310 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.968290736e-320 -1.111054115;
    -384.963207 -304.025857 -321.93299 -347.882065 -402.911893 -436.069645 -452.774411 -488.234898 -530.559393 -560.848593 -602.423524 -635.130632 -670.459919 -728.279801 -688.758808 -774.301471 -798.229979 -831.6592 -837.884152 -907.87257 -907.077846 -923.168788 -1027.387687 -947.994597 -1082.430304 -1032.117561 -1068.001552 -1106.393274 -1126.580796 -1171.11717 -1271.978455 -1242.149979 -1334.656157 -1291.939101 -1356.919047 -1464.608061 -1423.631557 -1474.967599 -1507.275486 -1549.355343 -1585.192279 -1610.856666 -1663.779986 -1696.300565 -1750.499848 -1800.63501 -1806.319685   0 4.644744869e-310 4.644744869e-310 3.162020133e-322 6.671862481e-320 -1.141926463 7.617964891e-312   0 4.644744868e-310 4.644744869e-310 4.644744869e-310 3.162020133e-322 6.893203891e-320 -1.140692685 7.639184849e-312 4.644744869e-310   0 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.1145453e-320 -1.139055692 7.660404807e-312   0 4.644744869e-310 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.335886709e-320 -1.137183373 7.681624765e-312 4.644744869e-310   0 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.557228119e-320 -1.135212529 7.702844723e-312   0 4.644744869e-310 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.778569528e-320 -1.133241185 7.724064681e-312 4.644744869e-310   0 4.644744869e-310 4.644744869e-310 3.162020133e-322 7.999910937e-320];







for  l = 1:3
    figure(1)
    subplot(3,1,l)
    legend('$K_1 = \omega, K_2 = 10$','$K_1 = \omega, K_2 = \omega$','Interpreter','latex')
    xlabel('time-frequency $\omega$','Interpreter','latex')

    if l == 1
        ylabel('relativ L^2-error [%]')
        title('\textbf{square medium velocity $u$}','Interpreter','latex')
        %      axis([8,max(W),0.04,0.16])
    elseif l == 2
        title('\textbf{source $f_2$}','Interpreter','latex')
        ylabel('relativ L^2-error [%]')
        %      ylabel('mean absolute error (MAE)')
        %      axis([8,max(W),0.5,1])
    elseif l == 3
        title('\textbf{source $f_2$}','Interpreter','latex')
        ylabel('relativ L^2-error [%]')
        %      ylabel('mean absolute error (MAE)')
    else
        title('Computation time')
        ylabel('time [min]');
        axis([8,max(W),0,25])
    end


end




figure(4)
uu = reshape(ut,NN+1,NN+1);
ff1 = reshape(ft1,NN+1,NN+1);
ff2 = reshape(ft2,NN+1,NN+1);
[x,y] = meshgrid(0:1/NN:1);
subplot(2,2,1)
surf(x,y,uu')
view([0,0,1])
shading interp
colormap jet
colorbar
caxis([0.75 2.5])

subplot(2,2,2)
surf(x,y,ff1')
view([0,0,1])
shading interp
colormap jet
colorbar
caxis([-0.1 2])
subplot(2,2,3)
surf(x,y,ff2')
view([0,0,1])
shading interp
colormap jet
colorbar
caxis([-0.1 2])
%
%
%
% % K1 = 2; K2 = 1;
w = W(end);
for k = KK
    figure
    % stru = "approx_K/uh_"+k+"_"+K1+"_"+K2+"_"+NN+"_"+w+".txt";
    % strf1 = "approx_K/fh1_"+k+"_"+K1+"_"+K2+"_"+NN+"_"+w+".txt";
    % strf2 = "approx_K/fh2_"+k+"_"+K1+"_"+K2+"_"+NN+"_"+w+".txt";

    stru = "approx_K/uh_"+k+"_"+K1+"_"+K2+"_"+NN+"_"+w+".txt";
    strf1 = "approx_K/fh1_"+k+"_"+K1+"_"+K2+"_"+NN+"_"+w+".txt";
    strf2 = "approx_K/fh2_"+k+"_"+K1+"_"+K2+"_"+NN+"_"+w+".txt";



    uh = import_freefem_vector(stru);
    fh1 = import_freefem_vector(strf1);
    fh2 = import_freefem_vector(strf2);

    uu = reshape(uh,NN+1,NN+1);
    ff1 = reshape(fh1,NN+1,NN+1);
    ff2 = reshape(fh2,NN+1,NN+1);
    [x,y] = meshgrid(0:1/NN:1);

    max(uu(:))
    max(ff1(:))
    max(ff2(:))

    subplot(2,2,1)
    surf(x,y,uu')
    view([0,0,1])
    shading interp
    colormap jet
    caxis([0.75 2.5])
    colorbar
    subplot(2,2,2)
    surf(x,y,ff1')
    view([0,0,1])
    shading interp
    colormap jet
    caxis([-0.1 2])
    colorbar
    subplot(2,2,3)
    surf(x,y,ff2')
    view([0,0,1])
    shading interp
    caxis([-.1 2])
    colorbar
    colormap jet

    subplot(2,2,4)
    title(k+"_"+K1+"_"+K2)
    [max(uh),max(fh1),max(fh2)]
end





%
%
%
% time = [
%      -95.112209 -79.278253 -81.29968 -83.191237 -84.957626 -87.696545 -89.54707 -95.62639 -96.801607 -97.583405 -104.017539 -111.855271 -110.306092 -115.747002 -117.075709 -127.014892 -135.559138 -137.861952 -138.909077 -145.910612 -142.775812 -145.33121 -152.882683 -146.75238 -155.525644 -151.241155 -151.193419 -144.547546 -150.701672 -145.073197 -150.069867 -152.828601 -149.365077 -158.189386 -159.405418 -160.10459 -157.531107 -157.818093 -160.084465 -162.720132 -171.598436 -174.621275 -179.230367 -155.702765 -156.849107 -181.192129 -161.564893 2.628443238e-264 1.398043286e-76 3.425400388e-86 1.398043286e-76 1.398040655e-76 3.000599277e-264 1.398043286e-76 3.42554452e-86 1.398043286e-76 1.397369703e-76 1.690130625e-52 1.398043276e-76 1.782280853e-72 4.857874933e-33 4.85787506e-33 1.131062177e-42 5.979841124e-154 1.782280853e-72 1.398043286e-76 1.303696426e-76 1.398043286e-76 1.398040655e-76 2.380339213e-264 1.398043286e-76 3.425400364e-86 1.398043286e-76 1.398040655e-76 2.752495251e-264 1.398043286e-76 3.425535316e-86 1.398043286e-76 1.397369703e-76 6.004550192e-67 1.398043276e-76 2.906964063e-33 4.857874933e-33 4.85787506e-33 2.12445136e-264 1.398043286e-76 3.425519975e-86 1.398043286e-76 1.397369702e-76 6.004550192e-67 1.398043276e-76 1.771505073e-72 1.398043286e-76 1.397369703e-76 3.935142014e-62 1.398043276e-76 1.782833567e-72 1.398043286e-76 1.303696426e-76 1.398043286e-76;
% 	 -92.462345 -79.854609 -80.446505 -86.020997 -90.114133 -99.274113 -102.273511 -106.947598 -113.636826 -117.037907 -121.432423 -126.568485 -132.89002 -137.884669 -144.864967 -148.81199 -155.789758 -161.535148 -166.631483 -172.690559 -171.292251 -181.212505 -185.603045 -190.135455 -194.023804 -204.393327 -197.42653 -188.711686 -219.418069 -201.328607 -205.371354 -211.070213 -215.703999 -219.740701 -223.358286 -232.441236 -236.74982 -224.547264 -212.227578 -230.981757 -225.606187 -221.890891 -231.870629 -233.058168 -236.977075 -241.376674 -244.069628 1.398043286e-76 1.303696433e-76 1.398043286e-76 1.398040655e-76 4.06572491e-265 1.398043286e-76 1.303696444e-76 1.398043286e-76 1.398040655e-76 2.876547264e-264 1.398043286e-76 3.425526111e-86 1.398043286e-76 2.722511457e-77 4.84957258e-33 4.857875059e-33 5.980062486e-154 1.398043286e-76 1.397369702e-76 6.004550192e-67 1.398043276e-76 1.782833567e-72 1.398043286e-76 1.303696431e-76 1.398043286e-76 1.398040655e-76 4.064513465e-265 1.398043286e-76 1.303696436e-76 1.398043286e-76 1.398040655e-76 2.504391225e-264 1.398043286e-76 5.980062843e-154 4.85787506e-33 2.722933144e-77 4.84957258e-33 2.124451361e-264 1.303696423e-76 1.398043286e-76 1.398040655e-76 2.2562872e-264 1.398043286e-76 3.425523043e-86 1.398043286e-76 1.397369702e-76 1.559979106e-259 1.398043286e-76 3.425526111e-86 1.398043286e-76 1.397369702e-76 6.004550192e-67 1.398043276e-76;
% 	 -96.77654 -75.911441 -81.052683 -82.373046 -82.882542 -81.208138 -85.847922 -80.893198 -85.672225 -81.726177 -86.2909 -88.574103 -87.368675 -92.741142 -102.808073 -101.507754 -97.73117 -103.890407 -103.270549 -104.257009 -95.038807 -99.988817 -99.092101 -102.936583 -96.923804 -94.410604 -93.31526 -90.079227 -88.947372 -86.289227 -82.871097 -89.572564 -90.800571 -92.016965 -96.707635 -94.155037 -103.10333 -93.79857 -97.974204 -90.859967 -91.20873 -97.529977 -91.288091 -92.211086 -93.668914 -93.7212 -95.411365 1.397369703e-76 1.690130625e-52 1.398043276e-76 1.783938997e-72 1.398043286e-76 1.303696323e-76 3.11774071e-33 1.398043276e-76 1.784215354e-72 1.398043286e-76 1.303696433e-76 1.398043286e-76 2.348621842e-154 4.85787506e-33 1.131062177e-42 3.224465092e-86 5.980062486e-154 1.398040655e-76 2.2562872e-264 1.398043286e-76 3.425526111e-86 1.398043286e-76 1.397369703e-76 2.57893467e-57 1.398043276e-76 1.783386282e-72 1.398043286e-76 1.303696323e-76 1.107644007e-47 1.398043276e-76 1.783386282e-72 1.398043286e-76 1.303696426e-76 5.980062486e-154 4.857842628e-33 4.85787506e-33 4.85787506e-33 1.397369702e-76 9.16221648e-72 1.398043276e-76 1.782280853e-72 1.398043286e-76 1.303696426e-76 1.398043286e-76 1.398040655e-76 2.2562872e-264 1.398043286e-76 3.425400352e-86 1.398043286e-76 1.398040655e-76 2.2562872e-264 1.398043286e-76 3.425519975e-86;
% 	 -94.186829 -78.793596 -86.164531 -89.515924 -95.106609 -102.400349 -111.585334 -118.693534 -123.400938 -131.696462 -137.833203 -144.36496 -154.980032 -163.503425 -170.040603 -169.674904 -186.086472 -192.042593 -201.674413 -210.151258 -217.946742 -205.97825 -215.400129 -224.182367 -226.186132 -228.449542 -243.561915 -238.661786 -244.681349 -251.678985 -271.440246 -283.822829 -294.780216 -318.062136 -287.274089 -296.810865 -299.999376 -310.445318 -334.361505 -325.413783 -332.076751 -340.751025 -354.016854 -357.860733 -363.724093 -372.943162 -379.661635 2.628443238e-264 1.398043286e-76 3.425535316e-86 1.398043286e-76 1.397369703e-76 3.11774071e-33 1.398043276e-76 1.77151263e-72 1.398043286e-76 1.397369703e-76 1.690130625e-52 1.398043276e-76 4.061446844e-265 4.84957258e-33 4.857875059e-33 4.85787506e-33 1.398040655e-76 4.061484851e-265 1.398043286e-76 1.303696428e-76 1.398043286e-76 1.398040655e-76 2.504391225e-264 1.398043286e-76 3.425532248e-86 1.398043286e-76 1.397369703e-76 1.107644007e-47 1.398043276e-76 1.771508312e-72 1.398043286e-76 1.397369703e-76 6.004550192e-67 2.348621841e-154 3.129029596e-264 2.906963793e-33 4.857875059e-33 1.397381652e-259 1.398043286e-76 3.425519975e-86 1.398043286e-76 1.397369702e-76 6.004550192e-67 1.398043276e-76 1.78255721e-72 1.398043286e-76 1.303696428e-76 1.398043286e-76 1.398040655e-76 4.062696297e-265 1.398043286e-76 1.303696426e-76 1.398043286e-76;
% 	];
%

time = timeAE100(:,1:length(W));
%tt = time(1,:)<-0.1;
% time = abs(time(:,tt));




TT200 = -[ -2456.955687 -2669.072434 -2562.920284 -1791.334337 -2301.894604 -1899.034532 -2643.599134 -4322.654832 -2179.681547 -2703.616936 -2852.42784 -3755.489964 -5520.024622 -5437.181859 -4550.755 -4986.911557 -2267.293453 -2689.444654 -1466.200619 -5431.245594 -2329.716128 -1504.729027 -3508.959916 -6023.959159 -7289.276122 -6380.821866 -2712.400061 -2621.351259 -5130.483063 -3006.639243 -1565.949231 -2018.877643 -1553.840556 -1568.555934 -2568.004026 -1576.137654 -2225.245094 -1974.050405 -2147.872772 -6116.059115 -2915.71003 -4957.237597 -2425.424682 -2754.237255 -1942.94474 -1813.319622 -1817.853492   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0;
    -2443.479827 -2492.50936 -5104.051196 -1819.428544 -1827.303327 -2106.565543 -1884.396478 -2502.11807 -1692.327357 -2454.548793 -3860.13261 -2532.079348 -2557.284478 -3491.217946 -3317.913847 -5892.967127 -3142.507529 -2182.085622 -2214.827301 -2251.796018 -2275.495761 -2247.733163 -3362.017895 -5180.609038 -3852.234539 -3742.976999 -5494.067503 -2860.403784 -4485.865245 -2661.109345 -2423.404265 -2452.838473 -2799.686887 -4985.850768 -5285.597125 -7285.055894 -2836.062677 -2765.071038 -2740.074618 -2773.081344 -4092.594849 -3826.388803 -4986.074472 -7231.203319 -3966.898033 -4957.169323 -6652.686779   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0;
    -2414.646611 -3164.005277 -2532.831397 -3831.33562 -1751.937943 -1545.973908 -1765.909443 -1766.424599 -1539.96427 -1775.620945 -3473.660105 -1822.492749 -1818.022897 -2841.062833 -4671.778294 -5993.265255 -1889.358541 -1885.322744 -1569.339155 -1773.403432 -1657.171745 -2216.559737 -1281.675362 -4257.466051 -1913.647547 -2480.314517 -3644.898695 -5753.293037 -5611.209567 -2476.499515 -1897.832701 -2465.16495 -1908.792785 -1721.932607 -4106.682724 -1350.116453 -2034.346309 -4235.040716 -1962.201629 -2243.014204 -3440.172563 -6084.479401 -5689.269671 -6211.168627 -7362.972235 -2095.576464 -1155.917206   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0;
    -2441.918403 -2589.952638 -2582.03472 -1817.779474 -2450.629334 -2073.564404 -1929.121726 -3255.401609 -2839.006173 -2570.562694 -2609.319375 -3501.969526 -2937.231987 -4479.345327 -4362.715128 -4909.786588 -3893.274568 -3271.247336 -2832.085836 -2410.155954 -3100.222959 -1748.602596 -3286.214044 -4320.609446 -4909.498826 -5179.560873 -4494.613832 -4844.836061 -5082.870313 -2426.25773 -3679.889187 -3067.9691 -2700.76465 -2777.096687 -5241.118369 -5924.111105 -6786.307306 -3118.159766 -3152.380917 -2851.289547 -3314.892749 -6291.10411 -5913.889606 -4741.259646 -4101.590927 -7892.895759 -3346.100104   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0];

TT100 = -[
    -674.558277 -1177.057048 -937.234353 -510.253039 -660.424236 -708.324979 -563.515619 -567.917579 -528.410531 -671.13996 -1275.055755 -744.322717 -873.601621 -1154.062825 -1656.18298 -1541.489891 -1063.717099 -673.174117 -637.44034 -575.421221 -509.883481 -1115.372769 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063861e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063861e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063861e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063861e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063865e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376321e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310;
    -666.587714 -685.364215 -1384.43606 -518.986048 -548.542957 -579.327054 -535.664031 -687.829331 -474.084617 -1402.221854 -889.603959 -790.981941 -946.210567 -1050.825411 -1615.651262 -1088.635067 -583.905673 -589.79198 -599.149483 -604.362181 -612.055585 -763.104556 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063861e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063861e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063861e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063861e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310;
    -670.159166 -1004.210973 -711.239705 -1163.547523 -607.348123 -510.367708 -798.637427 -518.137611 -440.840903 -713.471619 -966.46707 -520.928327 -1042.970839 -683.033387 -1032.15471 -1461.063768 -1591.872556 -793.376985 -727.941467 -858.530063 -938.605362 -439.007274 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063861e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063861e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063861e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063861e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310   0 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310;
    -665.262601 -1032.143146 -1025.080139 -525.005956 -672.739022 -597.140896 -569.599983 -602.442948 -1023.776921 -922.766102 -665.323027 -652.688266 -713.610364 -1221.238296 -1687.822532 -1158.220404 -973.772683 -1033.008244 -684.573237 -1326.371113 -743.742039 -448.863879 6.923376324e-310 4.940656458e-324 4.685063861e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063861e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063861e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063861e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063865e-310 4.685063865e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310 6.923376324e-310 4.940656458e-324 4.685063862e-310 4.685063866e-310 4.685063866e-310 6.923376324e-310];

total = sum(TT100(:,1:length(W)),2);
AEtotal =  sum(time,2);




%timeTotal = TT100(:,1:length(W));



figure
plot(W, time(1,:),'-*',W, time(4,:),'-s')
legend('$K_1 = \omega, K_2 = 10$','$K_1 = \omega, K_2 = \omega$','Interpreter','latex')
xlabel('\textbf{time-frequency $\omega$}','Interpreter','latex')
ylabel('\textbf{time [s]}','Interpreter','latex')
axis tight

p = 100./total(K).*AEtotal(K,:)
